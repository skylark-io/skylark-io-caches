/**
 * skylark-io-caches - The skylarkjs web local storage classes library.
 * @author 
 * @version v0.9.0
 * @link 
 * @license MIT
 */
!function(e,n){var t=n.define,require=n.require,r="function"==typeof t&&t.amd,i=!r&&"undefined"!=typeof exports;if(!r&&!t){var o={};t=n.define=function(e,n,t){"function"==typeof t?(o[e]={factory:t,deps:n.map(function(n){return function(e,n){if("."!==e[0])return e;var t=n.split("/"),r=e.split("/");t.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?t.pop():t.push(r[i]));return t.join("/")}(n,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:t}},require=n.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var t=[];module.deps.forEach(function(e){t.push(require(e))}),module.exports=module.factory.apply(n,t)||null,module.resolved=!0}return module.exports}}if(!t)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-io-caches/cache",["skylark-langx/skylark"],function(e){return e.attach("storages.cache",{})}),e("skylark-io-caches/cookie",["skylark-langx/langx","./cache"],function(e,n){function t(){return t}return e.mixin(t,{get:function(e){return sKey&&this.has(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},has:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},list:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),n=0;n<e.length;n++)e[n]=unescape(e[n]);return e},remove:function(e,n){e&&this.has(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; path="+n:""))},set:function(n,t,r,i,o,c){if(n&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(n)){var a=e.type(r);if("number"===a){var s=Date.now();s.setTime(s.getTime()+24*expire*60*60*1e3),r=s}else"string"===a&&(r=new Date(Date.now()+e.parseMilliSeconds(r)));document.cookie=escape(n)+"="+escape(t)+(r?"; domain="+r.toGMTString():"")+(o?"; domain="+o:"")+(i?"; path="+i:"")+(c?"; secure":"")}}}),n.cookie=t}),e("skylark-io-caches/LocalFileSystem",["skylark-langx/langx","./cache"],function(e,n){var t=e.Deferred,r=window.requestFileSystem||window.webkitRequestFileSystem;window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL,window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;function i(e){var n="";switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:n="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:n="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:n="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:n="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:n="INVALID_STATE_ERR";break;default:n="Unknown Error"}return n}var o=e.Evented.inherit({_fs:null,_isPersisted:!0,_cwd:null,init:function(e){this._fs=e,this._cwd=e.root},readfileAsArrayBuffer:function(e,n,t){this._cwd.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(){n(null,this.result)},t.readAsArrayBuffer(e)},t)},t)},readfileAsDataURL:function(e,n,t){this._cwd.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(){n(null,this.result)},t.readAsDataURL(e)},t)},t)},readfileAsText:function(e,n,t){this._cwd.getFile(e,{},function(e){e.file(function(e){var t=new FileReader;t.onloadend=function(){n(null,this.result)},t.readAsText(e)},t)},t)},writefile:function(e,n,t,r){var i=this,o=e.split("/");o=o.slice(0,o.length-1),this.mkdir(o.join("/"),function(){i._cwd.getFile(e,{create:!0},function(e){e.createWriter(function(e){var i=!1;e.onwriteend=function(){if(!i)return i=!0,void this.truncate(this.position);t&&t()},e.onerror=r;var o=n;!o instanceof Blob&&(o=new Blob([n],{type:"text/plain"})),e.write(o)},r)},r)})},rmfile:function(e,n,t){this._cwd.getFile(e,{},function(e){e.remove(function(){n()},t)},t)},readdir:function(e,n,t){this._cwd.getDirectory(e,{},function(e){var r=e.createReader(),i=[];!function e(){r.readEntries(function(t){t.length?(i=i.concat(Array.prototype.slice.call(t).map(function(e){return e.name+(e.isDirectory?"/":"")})),e()):n(null,i)},t)}()},t)},mkdir:function(e,n,t){var r=e.split("/"),i=function(o,c){"."!=c[0]&&""!=c[0]||(c=c.slice(1)),0!=c.length?o.getDirectory(c[0],{create:!0,exclusive:!1},function(o){if(o.isDirectory)c.length&&1!=r.length?i(o,c.slice(1)):n&&n(o);else{var a=new Error(e+" is not a directory");if(!t)throw a;t(a)}},function(e){if(!t)throw e;t(e)}):n(o)};i(this._cwd,r)},rmdir:function(e,n,t){this._cwd.getDirectory(e,{},function(e){e.removeRecursively(function(){n()},t)},t)},copy:function(e,n,t){this._cwd.getFile(e,{},function(e){cwd.getDirectory(n,{},function(n){e.copyTo(n,function(){t()},t)},t)},t)},move:function(e,n,t){this._cwd.getFile(e,{},function(e){cwd.getDirectory(n,{},function(n){e.moveTo(n,function(){t()},t)},t)},t)},chdir:function(e,n){this._cwd.getDirectory(e,{},function(e){cwd=e,fs.onchdir&&fs.onchdir(cwd.fullPath),n()},n)},importFromHost:function(e){for(var n,r=new t,o=0;n=e[o];++o)!function(e){cwd.getFile(n.name,{create:!0,exclusive:!0},function(n){n.createWriter(function(n){n.write(e)},i)},i)}(n);return r.promise},exportToHost:function(){}});return e.mixin(o,{isSupported:function(){return!!r},request:function(e,n){e=e||10485760;var i=n?PERSISTENT:TEMPORARY,c=new t;return r(i,e,function(e){var t=new o(e,!!n);c.resolve(t)},function(e){c.reject(e)}),c.promise}}),n.requestLocalFileSystem=o.request,n.LocalFileSystem=o}),e("skylark-io-caches/localStorage",["skylark-langx/langx","./cache"],function(e,n){var t=null;try{t=window.localStorage}catch(e){}function r(){return r}return e.mixin(r,{isSupported:function(){return!!t},set:function(n,r){return void 0===r?this.remove(n):(t.setItem(n,e.serializeValue(r)),r)},get:function(n,r){var i=e.deserializeValue(t.getItem(n));return void 0===i?r:i},remove:function(e){t.removeItem(e)},clear:function(){t.clear()},list:function(){for(var e={},n=0;n<t.length;n++)e[key]=t.key(n);return values}}),n.localStorage=r}),e("skylark-io-caches/sessionStorage",["skylark-langx/langx","./cache"],function(e,n){var t=null;try{t=window.sessiionStorage}catch(e){}return e.mixin(function e(){return e},{isSupported:function(){return!!t},set:function(n,r){return void 0===r?this.remove(n):(t.setItem(n,e.serializeValue(r)),r)},get:function(n,r){var i=e.deserializeValue(t.getItem(n));return void 0===i?r:i},remove:function(e){t.removeItem(e)},clear:function(){t.clear()},list:function(){for(var e={},n=0;n<t.length;n++)e[key]=t.key(n);return values}}),n.sessionStorage=sessionStorage}),e("skylark-io-caches/main",["./cache","./cookie","./LocalFileSystem","./localStorage","./sessionStorage"],function(e){return e}),e("skylark-io-caches",["skylark-io-caches/main"],function(e){return e})}(t),!r){var c=require("skylark-langx-ns");i?module.exports=c:n.skylarkjs=c}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-io-caches.js.map
